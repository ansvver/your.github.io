<script src="{{ ASSET_PATH }}geekeeper/js/jquery.min.js"></script>

<style type="text/css">
	.init_box {
		width: 60px; 
		height: 60px; 
		margin: 10px; 
		float: left; 
		background-color: yellow;
		text-align:center;
		line-height: 60px;
		font-size: xx-small;
	}
	.btn_box {
		width: 70px; 
		height: 30px; 
		margin: 10px; 
		float: left; 
		background-color: white;
		text-align:center;
		line-height: 30px;
		font-size: xx-small;
		border-width: 1px;
		border-style: solid;
		border-color: green;
		color: green;
		CURSOR: hand;
	}
	.text_box {
		width: 200px; 
		height: 30px; 
		margin: 10px; 
		float: left; 
		text-align:center;
		line-height: 30px;
		color: green;
	}
	.select_box {
		border-width: 2px;
		border-color: red;
		border-style: solid;
	}
	.open_box {
		background-color: green;
		color: white;
	}

	.btn { 
		BORDER-RIGHT: #7b9ebd 1px solid; 
		PADDING-RIGHT: 10px; 
		BORDER-TOP: #7b9ebd 1px solid; 
		PADDING-LEFT: 10px; 
		FONT-SIZE: 12px; 
		BORDER-LEFT: #7b9ebd 1px solid; 
		CURSOR: hand; 
		COLOR: green; 
		PADDING-TOP: 2px; 
		BORDER-BOTTOM: #7b9ebd 1px solid 
	} 
</style>

<script type="text/javascript">
	var cwin_num = 0;
	var clost_num = 0;
	var ncwin_num = 0;
	var nclost_num = 0;
	var game_num = 0;

	var $newbox = $( "<div class='a'/>" ).html("点击选择").addClass("init_box");

	function newGame(){
		game_num++;
		var i;
		var i_id;
		var prise = parseInt(Math.random() * 3);
		var tt=0;

		for(i=0; i<3; i++) {
			i_id = game_num + "" + i;
			$newbox.attr("id", i_id);
			if(prise == i) {
				$("#game").append($newbox.clone().addClass("prise"));
			} else {
				$("#game").append($newbox.clone());
			}
		}

		$("#game").append("<br><br>");

		$("#game").delegate(".a","click",function(){
			$(this).addClass("select_box").html("我选这个");
			
			var $tt_div = $("<div style='clear:both;' id='s" + game_num + "'><div class='text_box'>请选择：To 换 or Not To 换?</div><div class='change btn_box'>换换更健康</div><div class='not_change btn_box'>换你妹夫啊</div></div><br/>");

			if( $("#game").append($tt_div) &&  (tt += 1) && if(tt!=game_num) {$("#s" + game_num).remove()});	


			//产生一个随机数1或2
			var re = parseInt(Math.random() * 2) + 1;
			var help_id;
			var change_id;
			var next_id;

			var this_id = $(this).attr("id");
			var index = this_id.substring(this_id.length - 1, this_id.length);


			if( $(this).hasClass("prise") ) {
				help_id = game_num + "" + ((parseInt( index ) + re) % 3);
				change_id = game_num + "" + ((parseInt( index ) + (re % 2 ) + 1 ) % 3);
			} else {
				next_id = game_num + "" + ((parseInt( index ) + 1) % 3);
				if( $("#" + next_id).hasClass("prise") ) {
					help_id = game_num + "" + ((parseInt( index ) + 2) % 3);
					change_id = next_id;
				} else {
					help_id = next_id;
					change_id = game_num + "" + ((parseInt( index ) + 2) % 3);	
				}
			}
			$("#" + help_id).addClass("open_box").html("木有");		
			$("#" + change_id).html("???");	
			//$("#" + help_id).animate({outlineWidth:"10px"}, "slow").animate({outlineWidth:"0px"}, "slow");

			$(".a").removeClass("a");

			//$("#game").append("<div style='clear:both;' id='s" + game_num + "'><div class='text_box'>请选择：To 换 or Not To 换?</div><div class='change btn_box'>换换更健康</div><div class='not_change btn_box'>换你妹夫啊</div></div><br/>");

			$(".btn_box").click(function(){
				$(".btn_box").remove();
				$("#s" + game_num).append("<div class='text_box'>" + $(this).html() + "</div>");

				if( $(this).hasClass("change") ) {
					$("#" + this_id).removeClass("select_box").html("???");
					$("#" + change_id).addClass("open_box").addClass("select_box");
					if( $("#" + change_id).hasClass("prise") ){
						$("#" + change_id).html("中奖啦！");
						cwin_num++;
						$("#s" + game_num).append("<div class='text_box'>WIN !!!</div>");
					} else {
						$("#" + change_id).html("艹木有!");
						clost_num++;
						$("#s" + game_num).append("<div class='text_box'>LOST !!!</div>");
					}
				} else {
					$("#" + this_id).addClass("open_box");
					if($("#" + this_id).hasClass("prise")){
						$("#" + this_id).html("中奖啦！");
						ncwin_num++;
						$("#s" + game_num).append("<div class='text_box'>WIN !!!</div>");
					} else {
						$("#" + this_id).html("艹木有！");
						nclost_num++;
						$("#s" + game_num).append("<div class='text_box'>LOST !!!</div>");
					}
				}	

				$("#game").append("<div style='clear:both;' id='g" + game_num + "'></div><div class='again btn_box'>再拉一菊</div><div class='end btn_box'>查看酱果</div></div><br/><div style='clear:both;'></div>");

				$(".btn_box").click(function(){
					$(".btn_box").remove();
					if($(this).hasClass("again")) {
						newGame();
					}
				});	


			});


		});
		
	}

	
	$(document).ready(function(){
		$("#go").click(function(){
			$("#go").hide();
			newGame();
		});
	});
	
</script>

<div id="game">
	<input type="button" id="go" value="开始游戏"></button>
</div>

<br/>
<br/>
